<div>
  <input id="q" placeholder="Search…" />
  <div id="groups"></div>
</div>
<script>
async function load() {
  const res = await fetch("./data/vocab.json");
  const all = await res.json();
  let current = all;
  const q = document.getElementById("q");
  q.addEventListener("input", () => {
    const s = q.value.toLowerCase();
    current = all.filter(w =>
      (w.es||"").toLowerCase().includes(s) ||
      (w.meaning_de||"").toLowerCase().includes(s) ||
      (w.meaning_en||"").toLowerCase().includes(s) ||
      (w.tags||"").toLowerCase().includes(s)
    );
    render(current);
  });
  render(current);
}
function render(list) {
  const byLetter = {};
  for (const w of list) {
    const l = (w.es||"#").normalize("NFKD").toLowerCase().replace(/[^a-zñáéíóúü]/g,"")[0] || "#";
    (byLetter[l] ||= []).push(w);
  }
  const groups = document.getElementById("groups");
  groups.innerHTML = "";
  for (const l of Object.keys(byLetter).sort()) {
    const sec = document.createElement("section");
    const h = document.createElement("h3"); h.textContent = l.toUpperCase();
    sec.appendChild(h);
    const ul = document.createElement("ul");
    for (const w of byLetter[l].sort((a,b)=>a.es.localeCompare(b.es))) {
      const li = document.createElement("li");
      li.textContent = `${w.es} (${w.pos||"?"}) — ${w.meaning_de||w.meaning_en||""}`;
      ul.appendChild(li);
    }
    sec.appendChild(ul);
    groups.appendChild(sec);
  }
}
load();
</script>
